---
import { OrderManagement } from "@/components/admin/orders/OrderManagement";
import MainLayout from "@/layouts/MainLayout.astro";
import { auth } from "@/lib";

export const prerender = false;

// Check admin permission
const authCheck = await auth.authenticateUser(Astro);

if (!authCheck.user) {
  return Astro.redirect("/login?redirectTo=/admin/orders");
}

if (authCheck.user.role !== "ADMIN") {
  return Astro.redirect("/unauthorized");
}
---

<MainLayout title="Order Management | Admin | Cazzert">
  <main class="container mx-auto p-4">
    <OrderManagement client:load />
  </main>
</MainLayout>
