---
import { ProductManagement } from "@/components/admin/products/ProductManagement";
import MainLayout from "@/layouts/MainLayout.astro";
import { auth } from "@/lib";

export const prerender = false;

// Check admin permission
const authCheck = await auth.authenticateUser(Astro);

if (!authCheck.user) {
  return Astro.redirect("/login?redirectTo=/admin/products");
}

if (authCheck.user.role !== "ADMIN") {
  return Astro.redirect("/unauthorized");
}
---

<MainLayout title="Product Management | Admin | Cazzert">
  <main class="container mx-auto p-4">
    <ProductManagement client:load />
  </main>
</MainLayout>
