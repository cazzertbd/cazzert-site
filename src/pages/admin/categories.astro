---
import { CategoryManagement } from "@/components/admin/category/CategoryManagement";
import MainLayout from "@/layouts/MainLayout.astro";
import { auth } from "@/lib";

export const prerender = false;

// Check admin permission
const authCheck = await auth.authenticateUser(Astro);

if (!authCheck.user) {
  return Astro.redirect("/login?redirectTo=/admin/categories");
}

if (authCheck.user.role !== "ADMIN") {
  return Astro.redirect("/unauthorized");
}
---

<MainLayout title="Category Management | Admin | Cazzert">
  <main class="container mx-auto p-4">
    <CategoryManagement client:load currentUser={authCheck.user} />
  </main>
</MainLayout>
